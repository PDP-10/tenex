;<134>PARAMS.MAC;5539    17-MAY-79 12:55:02    EDIT BY TAFT
; Turn off GATEWF on both Maxc1 and Maxc2
; Decrease MAXSYM and NRPLBG; increase NTDSIZ
;<134>PARAMS.MAC;5538     8-FEB-79 15:16:46    EDIT BY TAFT
; Increase NTDSIZ
;<134>PARAMS.MAC;5536    18-NOV-78 18:37:41    EDIT BY TAFT
; Reduce Maxc1 RESLOC to 22600 now that MCA is gone
;<134>PARAMS.MAC;5535    27-SEP-78 16:25:27    EDIT BY TAFT
; Turn off the MCA!
; Adjust Maxc1 host table for no MCA
; Make Maxc2 be a gateway to the Arpanet
;<134>PARAMS.MAC;5534     5-JUN-78 18:33:21    EDIT BY TAFT
; Change NRPLBG to 251000
;<134>PARAMS.MAC;5533    30-MAY-78 17:22:59    EDIT BY TAFT
; Increase size of Pup routing table
;<134>PARAMS.MAC;5532    20-APR-78 13:43:01    EDIT BY TAFT
; Put Maxc2 on the Arpanet as a distinct host
;<134>PARAMS.MAC;5531    24-JAN-78 12:43:34    EDIT BY TAFT
; Change disk configuration to 7 packs on Maxc1 and 4 on Maxc2
;<134>PARAMS.MAC;5530    17-JAN-78 16:06:17    EDIT BY TAFT
; Adjust Maxc2 MAXSYM to 200000
;<134>PARAMS.MAC;5529    10-DEC-77 17:02:22    EDIT BY TAFT
; Adjust NRPLBG to 250000
;<134>PARAMS.MAC;5528    25-NOV-77 19:18:39    EDIT BY TAFT
; Increase NTDSIZ
;<134>PARAMS.MAC;5527     3-JUL-77 16:46:44    EDIT BY TAFT
; Decrease NRPLBG to 254000
;<134>PARAMS.MAC;5526     3-JUL-77 16:22:51    EDIT BY TAFT
; Raise NNTBFS to 44000 (about all we have room for)
; Reduce NMSKT to 50
; Reduce Maxc2 NJOBS to 40
; Raise Maxc1 NPUPUN to 75, NPKTBF to 40
;<134>PARAMS.MAC;5525     7-MAY-77 22:33:42    EDIT BY TAFT
; Change NNTBFS back to 40000 -- more just won't fit!
;<134>PARAMS.MAC;5524     7-MAY-77 20:35:21    EDIT BY TAFT
; Up NNTBFS to 60000
;<134>PARAMS.MAC;5523    27-APR-77 20:20:14    EDIT BY TAFT
; Adjust Maxc2 RESLOC to 16700
;<134>PARAMS.MAC;5522    27-APR-77 18:58:06    EDIT BY TAFT
; Change disk configuration to 6 packs on Maxc1 and 3 on Maxc2.
; Allocate 6000 swapping pages on both systems.
;<134>PARAMS.MAC;5521     3-APR-77 17:29:32    EDIT BY TAFT
; Adjust Maxc2 RESLOC to 16600, MAXSYM to 174000
;<134>PARAMS.MAC;5520     3-APR-77 13:02:57    EDIT BY TAFT
; Include Arpanet software in Maxc2 even though it isn't used
; Reduce SSPT to 10000 on Maxc1
; Raise MAXCOR to 2000 on Maxc2
;<134>PARAMS.MAC;5519    25-JAN-77 22:46:11    EDIT BY TAFT
; Adjust RESLOC and MAXSYM for Maxc2
;<134>PARAMS.MAC;5518    25-JAN-77 19:49:46    EDIT BY TAFT
; Add defs for Maxc2
;<134>PARAMS.MAC;5517     4-JAN-77 14:46:44    EDIT BY TAFT
; Direct login/logout messages to NIL:
;<134>PARAMS.MAC;5516    28-SEP-76 16:24:14    EDIT BY TAFT
; Increase MAXSYM to 220000
;<134>PARAMS.MAC;5515    12-AUG-76 10:48:03    EDIT BY TAFT
; Increase NNTBFS back to 40000 to prevent net lockup problem.
; Net buffers moved to above swappable monitor.
; Change NRPLBG to 260000
;<134>PARAMS.MAC;5514    25-JUL-76 18:06:06    EDIT BY TAFT
; Reduce NNTBFS to 20000, raise MAXSYM to 214000, NRPLBG to 244000
;<134>PARAMS.MAC;5513    25-JUL-76 17:44:45    EDIT BY TAFT
; Raise NJOBS to 70, RESLOC to 25600
;<134>PARAMS.MAC;5512    17-JUL-76 18:34:44    EDIT BY TAFT
; Raise NPNETS to 20
;<134>PARAMS.MAC;5511    17-JUL-76 18:25:07    EDIT BY TAFT
; Add memory register data to NVIO communication region
;<134>PARAMS.MAC;5510    12-JUL-76 16:40:58    EDIT BY TAFT
; Increase SSPT to 11000
; Change NNTBFS to 30000, MAXSYM to 210000, NRPLBG to 240000
;<134>PARAMS.MAC;5509     9-JUL-76 05:02:23    EDIT BY TAFT
; Increase RESLOC to 24500
;<134>PARAMS.MAC;5508     9-JUL-76 04:30:32    EDIT BY TAFT
; Increase swapping storage from 4500 to 7500 pages
;<134>PARAMS.MAC;5507    19-APR-76 00:56:30    EDIT BY TAFT
; Decrease RESLOC to 24400
;<134>PARAMS.MAC;5506    14-APR-76 18:45:20    EDIT BY TAFT
; Decrease NSCNLN from 32 to 4, NXNVT from 32 to 24
; Increase NPUPLN from 24 to 40, NPUPUN from 47 to 64
; Change OTYLNE from 24 to 2
;<134>PARAMS.MAC;5505    11-JAN-76 22:52:15    EDIT BY TAFT
; Raise MAXSYM to 202000
;<134>PARAMS.MAC;5504    11-JAN-76 22:15:43    EDIT BY TAFT
; RESLOC to 25000
; Change BUG macro to declare bug routine conditionally external
;<134>PARAMS.MAC;5502    10-JAN-76 22:43:56    EDIT BY TAFT
; Make initial KFACT be 0 (distribute windfall to all groups)
;<134>PARAMS.MAC;5501     9-JAN-76 20:05:57    EDIT BY TAFT
; Install Parc changes in 1.34 PARAMS
;<135-TENEX>PARAMS.C;55     3-DEC-75 14:02:43    EDIT BY ROSENBERG
; INCREASE MAXSYM FROM 150000 TO 160000
;<134-TENEX>PARAMS.C;54    10-NOV-75 16:45:43    EDIT BY ALLEN
; INCREASE RESLOC
;<134-TENEX>PARAMS.C;53    10-NOV-75 13:39:56    EDIT BY ALLEN
; INCREASE NSKT TO 200
;<134-TENEX>PARAMS.C;52    10-OCT-75 08:30:47    EDIT BY CALVIN
; MTAN->4
;<134-TENEX>PARAMS.C;51    29-SEP-75 07:56:26    EDIT BY TOMLINSON
;MOVE "GENERATE ACTUAL TITLE" COMMENT
;<134-TENEX>PARAMS.C;50     5-SEP-75 15:50:40    EDIT BY ALLEN
;<134-TENEX>PARAMS.C;49     3-SEP-75 22:07:59    EDIT BY ALLEN
; ADD SOME PARAMETERS FOR NCP
;<134-TENEX>PARAMS.C;48     3-SEP-75 12:33:02    EDIT BY ALLEN
;<134-TENEX>PARAMS.C;47    19-AUG-75 08:05:10    EDIT BY CALVIN
; Added PLT to system C
;<134-TENEX>PARAMS.C;46    15-AUG-75 13:34:37    EDIT BY ALLEN
; REDUCED NRPLBG TO 210000 AND INCREASE NSUBI TO 6

;<134-TENEX>PARAMS.C;45    15-AUG-75 12:54:27    EDIT BY ALLEN
; SET NNTBFS TO 70000
;<134-TENEX>PARAMS.C;44    11-AUG-75 16:13:29    EDIT BY ALLEN
; SET NPACKS TO 5
;<134-TENEX>PARAMS.C;43    22-MAY-75 17:12:38    EDIT BY ALLEN
; DEFINE TELENET LINES (0)
;<134-TENEX>PARAMS.C;42    22-MAY-75 16:12:10    EDIT BY ALLEN
; PARAMETERIZE INITIAL VALUES OF DRMIN0,1,2
;<134-TENEX>PARAMS.C;41    22-MAY-75 15:48:01    EDIT BY ALLEN
; ADD INITIAL VALUE FOR KFACT
;<134-TENEX>PARAMS.C;40    23-APR-75 12:36:28    EDIT BY CLEMENTS
; PUT IN %V'S SYMBOL FOR FILE VERSION NUMBER
;<134-TENEX>PARAMS.C;39     9-APR-75 16:50:44    EDIT BY PLUMMER
; INCREASE NUMBER OF SUBINDICES TO 4
;<134-TENEX>PARAMS.C;38     8-APR-75 22:31:21    EDIT BY CLEMENTS
; BUG POINTERS SPLIT FOR SPLIT JSYS.MAC
;<134-TENEX>PARAMS.C;37    26-MAR-75 14:20:46    EDIT BY PLUMMER
; ADD ABSOKT CAPABILITY
;<134-TENEX>PARAMS.C;36    21-MAR-75 17:45:36    EDIT BY CLEMENTS
; INTERNED MOST EVERYTHING
;<134-TENEX>PARAMS.C;35    14-MAR-75 14:29:39    EDIT BY CLEMENTS
; IFDEF AROUND USE OF RESPC IN END MACRO
;<134-TENEX>PARAMS.C;34    13-MAR-75 22:34:13    EDIT BY PLUMMER
; INCLUDE CONDITIONALS FOR SIGNAL.MAC, BUT LEAVE TURNED OFF
;<134-TENEX>PARAMS.C;33     8-JAN-75 08:38:26    EDIT BY CALVIN
; Changed local host # to be 361
;<133-TENEX>PARAMS.C;32     1-JAN-75 09:57:41    EDIT BY TOMLINSON
; INCREASED SSPT TO 5000
;<133-TENEX>PARAMS.C;31    18-NOV-74 17:46:34    EDIT BY ALLEN
; increase RESLOC
;<CALVIN>PARAMS.C;1    18-NOV-74 13:00:19    EDIT BY CALVIN
;<133-TENEX>PARAMS.C;29    12-NOV-74 17:02:10    EDIT BY ALLEN
;<133-TENEX>PARAMS.C;28    12-NOV-74 16:59:25    EDIT BY ALLEN
;<133-TENEX>PARAMS.C;27    12-NOV-74 16:55:20    EDIT BY ALLEN
;<133-TENEX>PARAMS.C;26    11-NOV-74 11:37:52    EDIT BY ALLEN
; TURN ON PIE-SLICE OPTION
;<133-TENEX>PARAMS.C;25    19-SEP-74 12:37:43    EDIT BY ALLEN
; CORRECT SYS C HOST NUMBER
;<133-TENEX>PARAMS.C;24    17-SEP-74 12:50:14    EDIT BY CLEMENTS
;<133-TENEX>PARAMS.C;23    16-SEP-74 13:30:20    EDIT BY CLEMENTS
;<TENEX-132>PARAMS.C;22    25-JUN-74 19:45:49    EDIT BY CLEMENTS

;PARAMETERS FOR MAXC TENEX
; The file MAXC1.MAC or MAXC2.MAC is assembled ahead of
; PARAMS.MAC and appropriately defines MX(text1,text2) to assemble
; text1 or text2.

MAXC==MX(1,2)
MX(<	DEFINE SYSNAM(A,B) <A'MAXC1'B>>,<
	DEFINE SYSNAM(A,B) <A'MAXC2'B>>)

KAFLG==:1		; ON FOR A KA-10 AND PAGER
KIFLG==:0		; ON FOR A KI-10
BBNCLK==:0		; ON FOR THE BBN 1 MS CLK (KA-10 MOD)
DK10F==:0		; ON FOR TIMING VIA A DK10 CLOCK
;RTICLK==:1		; IF DEFINED, BBN GTAD CLOCK EXISTS
SIGIPC==:1		;IF DEFINED, SIGNAL.MAC ASSEMBLES

NJOBS==:MX(^D70,^D40)	;NUMBER OF JOBS ON SYSTEM
NSCNLN==:MX(^D4,^D2)	; NUMBER OF LINES ON SCANNER
NXNVT==0		; Number of MCA virtual terminals
NPUPLN==^D40		; Number of Pup virtual terminals
NNVTLN==:MX(^D8,^D8)	; NUMBER OF NVT'S (NETWORK TTY'S) TO SERVE
NPTY==:0		; NOT YET IMPLEMENTED - PSEUDO-TTY'S
NTNTLN==0		; NUMBER OF TELENET LINES
CTYLIN==:0		;NAME OF CONSOLE TTY
PTYLO==:NSCNLN		; FIRST LINE WHICH IS A PTY
PTYHI==:PTYLO+NPTY-1	; LAST ..
MCALO==:PTYLO+NPTY	; First line which is an MCA terminal
MCAHI==:MCALO+NXNVT-1	; Last ..
PUPLO==:MCALO+NXNVT	; First line which is a Pup virtual terminal
PUPHI==:PUPLO+NPUPLN-1	; Last ..
NVTLO==:PUPLO+NPUPLN	; FIRST LINE WHICH IS AN NVT
NVTHI==:NVTLO+NNVTLN-1	; LAST ..
TNTLO==:NVTLO+NNVTLN	;FIRST TELENET LINE
TNTHI==:TNTLO+NTNTLN-1	; LAST ...
NLINES==:TNTLO+NTNTLN	;TOTAL NUMBER OF "TTY"'S
NDLS==:1		;ONE TO INCLUDE CODE FOR THE TTY LINE SCANNER
NTTYS==:NSCNLN		; NUMBER OF HARDWARE TTY'S
OTYLNE==:MX(2,0)	; OPERATOR TTY (ENTRY ALLOWED EVEN IF DISC GONE)
USRSCF==:^D2000		; Initial contents of USRSPC (disk space level
			; below which users exceeding allocation cannot
			; do write OPENF)
SYSSCF==:^D500		; INITIAL CONTENT OF SYSSPC (DISK SPACE LEVEL
			;  BELOW WHICH NO NEW WRITES ARE ALLOWED
NTTBF==:NLINES*2	;NUMBER OF TTY BUFFERS
TTSIZ==:20		;SIZE OF INDIVIDUAL TTY BUFFER (POWER OF 2)
SSPT==:MX(10000,10000)	;SIZE OF SPT (H'WARE MAX IS 20000)
; Symbols defining the disk configuration
NPACKS==:MX(7,4)	; No. disk packs in file system
NPPCKS==:MX(7,4)	; No. packs in public structure (whatever that means)
NDVMAX==:8		; Maximum no. of disk drives
NARMS==:626		; No. arm positions
NSECS==:3		; No. sectors
NSURFS==:24		; No. surfaces
KMAX==:<NARMS-1>*10+<NSURFS-1>*10000+<NSECS-1>  ; Largest legal address
NPGTK==:NSURFS*NSECS	; Pages/track
NAREAS==:^D20		; No. save areas
NTRKPA==:4		; No. arm positions/save area
NTRKOP==:NARMS-<<NAREAS+NPACKS-1>/NPACKS>*NTRKPA  ; Free tracks/pack
NEWFB==:4		; New file bit (in linear address LH)
NBWTK==:<NPGTK+43>/44	; Words of bits per arm position
NSWPPG==:MX(^D6000,^D6000)  ; Number of swapping pages (approx.)
NSWPTK==:NSWPPG/<NPGTK*NPACKS>  ; No. swapping arm positions/pack
NTRACK==:<NTRKOP-NSWPTK>*NPACKS  ; Total file area tracks
DSKMSK==:777774		; Mask to clear non-disk-address bits
NDST==:NSWPTK*NPACKS*NPGTK  ; Pages of disk swap storage = length of DST
DRMII0==1015			;INITIAL VALUE FOR DRMIN0
DRMII1==1015			;INITIAL VALUE FOR DRMIN1
DRMII2==1423			;INITIAL VALUE FOR DRMIN2
TMZONE==:8		;LOCAL TIME ZONE. HOURS BEHIND GMT, SEE DATIME

IJSFRE==:100		; INITIAL SIZE OF JSB FREE AREA
NFDIB==:40		; NUMBER OF FILE DIRECTORY INDEX BLOCKS
			; LIMITS ULTIMATE NUMBER OF DIRECTORIES
NSUBI==:6		; NUMBER OF SUBINDICES ~NFDIB/5
;DTAN==:3			; NUMBER OF dectape units
MX(MTAN==:4,)		; NUMBER OF mag tape units 
;SSAN==:1			; ON IF SA-10 SSA INCLUDED FOR DISK OR TAPE
;SSAWCP==:^D11		; RIGHTMOST BIT OF WC FIELD OF DATA POINTERS.
			; THIS IS 15 FOR EARLY UNITS, 11 FOR LATE ONES
;SA10BF==:1		; SMART PACKING MODES EXIST
;SSATF==:1		; SA-10 USED FOR TAPES
;SSADF==:1		; SA-10 USED FOR DISKS
;SSATC==:1		; SUBCHANNEL OF SSA WHICH CONTROLS TAPES
;SSADC==:0		; SUBCHANNEL OF SSA WHICH CONTROLS DISKS
LPTN==:1			; LPT: EXISTS
;LPTDVF==:1		; Physical lpt exists
LPTSPL==:1		; Line printer spooler exists
LP10F==:0		; NO DEC LP10 PRINTER HARDWARE
BBNPF==:0		; NO BBN PRINTER (IT'S ON THE OTHER SYSTEM)
NETN==:1		; We have a network
NNTBFS==:44000		; SIZE OF NETWORK BUFFER AREA
NINBFS==^D8		; NUMBER OF INPUT BUFFERS TO KEEP AROUND
NSKT==:MX(^D50,^D25)	; Number of network sockets
LHOSTN==:MX(40,240)	; Local host number on Arpanet
INIACT==:^D220100	; ACCT SET AT JOB INIT - SITE OVERHEAD ACCT
IDRDPW==:775200		; DEFAULT DEFAULT FILE PROTECTION
IDRPRT==:776060		; DEFAULT DIRECTORY PROTECTION
DEFDGR==1B0		; Default directory group word ("Xerox users")
DEFUGR==1B0		; Default user group word ("Xerox users")
DEFDAL==^D500		; Default disk allocation per user
DEFMOD==1B1		; Default user mode word
DEFRES==0		; Default special resource information
;PLTN==:1		; Plotter exists
;PTPN==:1		; Paper tape punch exists
;PTRN==:1		; Paper tape reader exists
;NDP==:4		; Number of E&S display processes
;NDC==:2		; Number of E&S display consoles
;DACN==:1		; DAC EXISTS
;ADCN==:1		; AND ADC EXISTS
; MX(NMSKT==:^D50,)	; Number of MCA sockets

NPUPUN==:MX(^D75,^D50)	; Number of Pup ports
NPKTBF==:MX(^D40,^D32)	; Number of pages of Pup packet buffers
NPUPBF==:<^D30*NPUPUN+777>/1000  ; Number of pages of Pup free storage
NTDSIZ==:^D30		; Number of pages for mapping Pup directory
NPNETS==:^D40		; Number of networks allowed in routing table
GATEWF==:0		; We are a gateway if 1

; Define addresses of local host connection to Pup inter-network
MX(<	DEFINE PUPHST(X) <  ; For Maxc1
		X(3,200,BROADCAST)  ; 35-Ethernet
		X(4,40)		; Arpanet
	>>,<
	DEFINE PUPHST(X) <  ; For Maxc2
		X(3,5,BROADCAST)  ; 35-Ethernet
		X(4,240)	; Arpanet
>>)

PIESLC==:1		;ASSEMBLY CONTROL FOR PIE-SLICE SCHEDULER
			;=0 MEANS NO SUCH FEATURE
			;NE 0 MEANS ASSEMBLE PIE-SLICE SCHEDULER CODE
IFN PIESLC,<
NGRPPG==:1		;NUMBER OF PAGES IN <SYSTEM>PIE-SLICE-GROUP.DATA
NWDGRP==:7		;NUMBER OF WORDS PER GROUP ENTRY
NGRPS==:<<NGRPPG*1000>-1>/NWDGRP	;NUMBER OF PIE-SLICE GROUPS
INIGP==:SIXBIT /SYSJOB/
KFINIT==0.0		;INITIAL VALUE FOR KFACT
>; END PIE-SLICE SCHEDULER CONDITIONAL


JTRPSW==:2		;ASSEMBLY CONTROL FOR JSYS TRAPPING MECHANISM
			;=0 MEANS NO SUCH FEATURE
			;=1 MEANS SINGLE PROCESSOR SYSTEM, MAP RES MON
			;	FOR TRAPPED FORKS
			;=2 MEANS HARDWARE MODIFIED TO DISPATCH JSYS'S
			;	THROUGH PAGE 600

IFDEF SIGIPC,<		;IF SIGNAL.MAC BEING ASSEMBLED:
NSSIGS==:10		;NUMBER OF SYSTEM SIGNALS
NUSIGS==:10		;NUMBER OF USER SIGNALS
>; END SIGNAL CONDITIONAL

OPTTY==:400000+CTYLIN	; OPERATOR TERMINAL DESIGNATOR
LOGTTY==:377777	; DESIGNATOR FOR LOGGING INFO
JB0TTY==:400001	; DESIGNATOR FOR JOB 0 AND ERROR MSGS.

DPKN==:NDVMAX		; No. drives for mounting auxiliary+system packs
NDSKS==:1		; Only one file structure, always

IFDEF DACN,<RTISW==:1>
IFDEF ADCN,<RTISW==:1>

SRIARC==:1		; Want SRI JSYS definitions for NLS

;IF PI CHANNEL FOR DEVICE IS NOT DEFINED, CODE FOR THAT DEVICE
;IS NOT ASEMBLED

DSKCHN==:4		;DISK
;RP02F==:1		;RP02/RP10 DISK
;DRMCHN==:4		;DRUM
DLSCHN==:5		;DLS AND TTY PI CHANNEL
;BBNDLS==:1		;FOR BBN-MODIFIED SCANNER
 ;DECDLS==:1		;FOR DEC STANDARD SCANNER
IFDEF MTAN,<
IFNDEF SSATF,<
IFDEF ADCN,<PRINTX CONFLICT OVER LOC 42 BETWEEN MTA: AND ADC:>
IFDEF DACN,<PRINTX CONFLICT OVER LOC 42 BETWEEN MTA: AND DAC:>
>
 MTDCHN==:1		;MAG TAPE DATA CHANNEL
 MTACHN==:4>		;MAG TAPE FLAGS CHANNEL
IFDEF DTAN,<
 DTDCHN==:2		;DECTAPE DATA
 DTACHN==:5>		;DECTAPE CONTROL
IFDEF SSAN,<
SSACHN==:5>		; SA-10 SSA FOR DISKS AND/OR TAPES
IFDEF NETN,<
 IMPCHN==:5>		;IMP (NETWORK)
IFDEF NMSKT,<
 MCACHN==:5>		; MCA
IFDEF NPUPUN,<
 PUPCHN==:5>		; Pup
IFDEF PTPN,<
 PTPCHN==:6>		;PAPER TAPE PUNCH
IFDEF PTRN,<
 PTRCHN==:5>		;PAPER TAPE READER
IFDEF PLTN,<
 PLTCHN==:6>		;PLOTTER
IFDEF LPTDVF,<
 LPTCHN==:6>		; LINE PRINTER PI CHANNEL
IFDEF NDP,<
 DSPCHN==:6>		; E&S DISPLAY
IFDEF DACN,<
 DACCHN==:1>		; DAC PI CHANNEL
IFDEF ADCN,<
 ADCCHN==:1>		; ADC PI CHANNEL

;GLOBAL PARAMETERS

SJFN==:4		;LOG2 NUMBER OF JFN WORDS

; Tenex registers displayed by NVIO.
; Up to 5 entries of the form XX loc,heading
; Heading limited to 12. characters

DEFINE NVREGS <
	XX (22,<NRUN-NBPROC>)
	XX (TODCLK,<TODCLK>)
	XX (21,<JOB-FORK>)
	XX (NRPLQ,<NRPLQ>)
	XX (SPTC,<SPTC>)
>

; Maxc-Nvio communication locations and communication parameters

; Communication locations for Nvio in Maxc "shadow" memory
SWICH==0		; Switches
;LITES==1		; Lites (conflicts with DEFJS in STENEX)
MTBS==3			; Points to large block beginning at MAXLOC (see below)
DLSBS==4		; Points to Dls communication block (104 long)
MAXNV==5		; Maxc-to-Nvio communication word (zero in bit
			; indicates Nvio has task to do)
; Device numbers for MAXNV (bit number is 43 - device number)
  ; 24 i/o reset
  DLSOBG==25		; DLS begin output
  MTCDEV==27		; CONO MTC device no.
  IMPOBG==32		; Imp begin output
  OMCA==33		; Mca signal device no.
  IMPIBG==34		; Imp begin input
  CDVS==35		; Multiple-purpose signal device no.  Word XCCHS
			; (defined below) is decoded
  PUPIBG==36		; Pup begin input
  PUPOBG==37		; Pup begin output
NVMAX==6		; Nvio-to-Maxc communication word
; Device numbers for NVMAX (bit number is 43 - device number)
  ; Devices 0-7 disk units sector interrupts
  ; 10 clock
  ; 11 magtape
  ; 12 unassigned
  DLSDN==13		; DLS input/output done
  IMPIDN==14		; Imp input-done device no.
  IMPODN==15		; Imp output-done device no.
  PUPIDN==16		; Pup input done
  PUPODN==17		; Pup output done
  IMCA==20		; Mca input-done device no.
  ; 21-25 unused
  ; 26 pushdown overflow
  ; 27 unused
  ; 30 man. inited int. PI chan 7
  ; 31 man. int. 6
  ; 32 man. int. 5
  ; 33 man. int. 4
  ; 34 man. int. 3
  ; 35 man. int. 2
  ; 36 man. int. 1
  ; 37 power failure
  ; 40 floating overflow
  ; 41 parity error
  ; 42 non-existent memory (=timeout)
  ; 43 overflow
STADR==7		; Points to auto starting address

MAXLOC==200		; 600 words for Maxc-Nova communication below
			;   the JSYS table
  TMCCO=MAXLOC+0	; Cono MTC request word
  MTIWC=MAXLOC+1	; Number of words actually read by Nova, shifted
  NVCHKA=MAXLOC+2	; Argument for Nvio bugchk's
  TMSCI=MAXLOC+3	; Coni MTS status word
  MTAC1=MAXLOC+4	; Word count and physical page list (5 words)
  TODCLK=MAXLOC+11	; Millisecond clock updated by Nvio
  XCCHS=MAXLOC+12	; Arg for CDVS request
  NVCHK=MAXLOC+13	; Pointer to place where Nvio bugchk's are stored
  MTAHST=MAXLOC+14	; Most recent unit status (8 words, one/unit)
  PSCAN=MAXLOC+24	; Parity scan word
  XMEMER=MAXLOC+25	; Memory error data left by Nvio
; Nvio relies on Mca input and output buffers being in same 64K hunk
; of main memory
  XMCIB=MAXLOC+26	; Input buffer pointer
  XMCIMR=MAXLOC+27	; MAXC read pointer
  XMCINW=MAXLOC+30	; NOVA write pointer
  XMCIE=MAXLOC+31	; End of input buffer pointer

  XMCOB=MAXLOC+32	; Output buffer pointer
  XMCONR=MAXLOC+33	; NOVA read pointer
  XMCMW=MAXLOC+34	; MAXC write pointer
  XMCOE=MAXLOC+35	; End of output buffer pointer

  XMUSED=MAXLOC+36	; Bytes output/host by MAXC (41 words)
  XNFREE=MAXLOC+77	; Bytes output by NVIO/host (41 words)
  XMCOFS=MAXLOC+140	; NVIO output free storage total
  XMHTT=MAXLOC+141	; Host translation table 256 bytes giving the
			; initial destination for each host no.
  NVMSG==MAXLOC+241	; Text displayed above flashing registers
  XPTRS==MAXLOC+265	; Addresses of five registers displayed

  XPUPIB=MAXLOC+272	; Pup input buffer communication word
  XPUPOB=MAXLOC+273	; Pup output buffer communication word
  XIMPIB=MAXLOC+274	; Imp input buffer communication word
  XIMPOB=MAXLOC+275	; Imp output buffer communication word
  XIMPSI=MAXLOC+276	; Imp status in

  XMAR=MAXLOC+277	; Contents of MAR at time of fatal memory error
  XMDR=MAXLOC+300	; MDR
  XMDRL=MAXLOC+301	; MDRL
  XKMAR=MAXLOC+302	; KMAR
  XKMDR=MAXLOC+303	; KMDR
  XKMDRL=MAXLOC+304	; KMDRL

DLSLOC==MAXLOC+400	; Beginning of 104-word DLS communication block
  DLSOD=DLSLOC		; DLS output done bits
  ; DLSLOC+1 unused
  DLSO=DLSLOC+2		; DLS output request bits (zeroes are requests)
  DLSIN=DLSLOC+3	; DLS input done bits
  DLSB=DLSLOC+4		; DLS input and output characters
			; Input char is at DLSB + 2*line #
			; Output char is at DLSB + 2*line# +1

;STORAGE BOUNDARIES, JUGGLED TO USE SPACE BETWEEN CST0 AND SPT

MAXCOR==:MX(2000,2000)	; MAXIMUM REAL CORE EVER USABLE

DEFINE	DX(NM,SIZ)
<	NM=DXX
	DXX==DXX+SIZ>

DEFINE	DXXCK(LOC,SIZNM,SIZV)<
IFG DXX+SIZV-LOC,<
    IFG LOC+SIZNM-DXX,<
	DXWST==DXWST+LOC-DXX
	DXX==LOC+SIZNM>>>

DXX==2000		;VARIOUS STORAGE STARTS AFTER JSYS DTB
DXWST==0		; SPACE WASTED HERE

IFN KIFLG,<		;PAGES NEEDED FOR KI-10 PAGER
DX(KIEPT,1000)
DX(KIUPT,1000)>
DX(LGBUF,1000)		;  Logging buffer for microcode (must be x1000)
DX(MMAP,1000)		; Monitor map (traditional 3000)
DX(CST0,MAXCOR)		; Pager core status table (traditional 4000)
DX(CST1,MAXCOR)
DX(CST2,MAXCOR)
DX(CST3,MAXCOR)
DX(SPT,SSPT)		; Shared pages table (BBN-pager 20000, must be x1000?)
DX(SPTH,SSPT)		; Parallel to SPT (hash table)
DX(TTBUFS,TTSIZ*<NTTBF+1>)	; TTY BUFFERS
 TTBUFF==1			; NOTE TTBUFS DEFINED HERE
DX(DST,NDST)		; Drum status table
DX(RESLOC,<MX(22600,16700)>)  ;ALL OTHER RESIDENT STORAGE
DX(RESMA0,40000)	; SKIP OVER POSSIBLE FIXED LOCATIONS
  INTERN RESMA0

DEFINE	PDXWST(N)<PRINTX !N WORDS WASTED IN DX STORAGE!>
IFG DXWST-400,<PDXWST(\DXWST)>

;MAX END OF SYMBOL TABLE, USED BY POSTLD

MAXSYM==:MX(205000,200000)

;SWAPPABLE STORAGE AND CODE BOUNDARIES

IFN KAFLG,<
PPRMPG=<MAXSYM+777>/1000  ; First page of per-processor region
NRESBG=<PPRMPG+4>*1000	;BEGINNING OF SWAPPABLE VARIABLE STORAGE
NRPLBG=240000		; " " SWAPPABLE PAGE STORAGE
>
IFN KIFLG,<
NRESBG=350000		;MAP LAID OUT DIFFERENTLY ON KI-10
NRPLBG=442000		; ..
>
SWPMP0==:400		; START OF SWAPPABLE CODE
SWPMA0==:SWPMP0*1000	; ..


; PROLOG-ISH THINGS THAT ARE COMMON TO BOTH FILE AND MON
; TO BE MOVED INTO COMMON PROLOG FILE WHEN IT EXISTS

; USE MACRO SWITCHES PC'S

DEFINE	USE(PC,IVAL)<
.OLDPC(.)		;; SAVE CURRENT LOCATION AS OLD PC
IFDIF <IVAL><><PC==IVAL>;; IF (OPTIONAL) IVAL, SET NEW PC TO IT
IFNDEF PC,<PRINTX PC NOT DEFINED>
ORG PC			;; SET LOCATION TO CURRENT VALUE OF PC
DEFINE	.OLDPC(V)<PC==V>;; REDEFINE OLD PC
>

; DEFINE ALTERNATES FOR TITLE AND END

IF1,<	SYN TITLE,.TITLE
	SYN END,.END>

; REDEFINE TITLE TO INIT PC'S AND BUGSTRINGS

DEFINE	TITLE(S)<
; GENERATE ACTUAL TITLE
.TITLE S
SEARCH STENEX		; Needed for Maxc opcodes and stuff
RESPC==.		; DEFINE RESPC AS RELOCATABLE 0
	TWOSEG SWPMA0		; SIDE EFFECT IS RELOC(SWPMA0)
DEFINE	.OLDPC(V)<SWAPPC==V>	;; SO REMEMBER THAT FACT
USE RESPC			; AND RETURN TO RESIDENT CODE
%P==%P'S			; DEFINE BUG PS'S
%S==%S'S
%IP==%P'S
%IS==%S'S
%IN==%N'S
IFDEF .DIRECTIVE,<.DIRECTIVE XSRCVN %V'S >	;REMEMBER FILE VERSION
SUPPRESS %P'S,%S'S,%N'S
>

; REDEFINE END TO CLEANUP AFTER ASSEMBLY

DEFINE	END(ZZZ)<
IFDEF RESPC,<IFN RESPC,<USE RESPC>>	; IF ANY RESIDENT CODE
LITS:	LIT			; MAKE LITS RESIDENT
IFDEF %IN,<
BUGOFL(<BUG POINTERS>,\<%P-%IP-%IN>); PRINT AMOUNT OF OVERFLOWS IF ANY
BUGOFL(<BUG STRINGS>,\<%S-%IS-10*%IN>)
PURGE %P,%S,%IP,%IS,%IN>; END IFDEF %IN

.END ZZZ>

; MACRO TO PRINT AMOUNT OF OVERFLOW IF ANY

DEFINE	BUGOFL(WHAT,AMOUNT)<
	IFG AMOUNT,<PRINTX WHAT OVERFLOW BY AMOUNT>
>

;MACROS FOR DEFINING BUGHLT AND BUGCHK STRINGS

;THIS IS THE MACRO THAT APPEARS IN THE CODE.  ITS FIRST ARG IS
;CHK OR HLT, AND CAUSES ASSEMBLY OF JSR BUGCHK OR JSR BUGHLT
;RESPECTIVELY.  ITS SECOND ARGUMENT IS A STRING DEFINING THE
;PROBLEM REPRESENTED BY THE CHECK.

DEFINE BUG (TYP,STR,PUSHF,%TG1,%TG2)<
%TG1:
ORG %S
%TG2:	ASCIZ /STR/
%S==.
ORG %P
	%TG1,,%TG2
%P==.
ORG %TG1
IFIDN <PUSHF>,<>,<	IF2,<IFNDEF BUG'TYP,<EXTERN BUG'TYP>>
			JSR BUG'TYP>
IFDIF <PUSHF>,<>,<	IF2,<IFNDEF BGR'TYP,<EXTERN BGR'TYP>>
			PUSHJ P,BGR'TYP>
IF2,<	PURGE %TG1,%TG2>
>

; Similar macro for defining NVIO bugstrings.

DEFINE NVBUG(VAL,STR,%TG1,%TG2) <
%TG1:
ORG %S
%TG2:	ASCIZ /STR/
%S==.
ORG %P
	VAL_4 ,, %TG2
%P==.
ORG %TG1
IF2,<	PURGE %TG1,%TG2>
>

; MOVX AC,VAL  generates MOVEI, MOVSI, or MOVE depending on VAL
DEFINE MOVX(AC,VAL) <
IFE <VAL>&777777000000,<MOVEI AC,VAL>
IFN <VAL>&777777000000,<
	IFE <VAL>&777777,<MOVSI AC,(VAL)>
	IFN <VAL>&777777,<MOVE AC,[VAL]>
>>
